# 1. USB KEYLOGGER SIMULATION
- id: 7f8a9b0c-1d2e-3f4a-5b6c-7d8e9f0a1b2c
  name: USB Keylogger Insertion
  description: Simulates malicious USB device with keylogger
  tactic: collection
  technique:
    attack_id: T1052.001
    name: Exfiltration over USB
  platforms:
    windows:
      psh:
        command: |
          echo "SIMULATION: USB Keylogger v1.0 inserted" > %TEMP%\keylog.txt
          echo "Recording keystrokes..." >> %TEMP%\keylog.txt
        cleanup: del %TEMP%\keylog.txt
    linux:
      sh:
        command: |
          echo "SIMULATION: USB Keylogger v1.0 inserted" > /tmp/keylog.txt
          echo "Recording keystrokes..." >> /tmp/keylog.txt
        cleanup: rm -f /tmp/keylog.txt

# 2. SENSITIVE DATA COLLECTION
- id: a1b2c3d4-e5f6-7890-abcd-ef1234567890
  name: Collect Sensitive Files
  description: Searches for and collects sensitive documents
  tactic: collection
  technique:
    attack_id: T1005
    name: Data from Local System
  platforms:
    windows:
      psh:
        command: |
          dir /s /b %USERPROFILE%\*.docx %USERPROFILE%\*.pdf %USERPROFILE%\*.xlsx 2>nul | findstr /i "confidential\|secret\|finance" > %TEMP%\collected.txt
          echo "Found sensitive files:" && type %TEMP%\collected.txt
        cleanup: del %TEMP%\collected.txt
    linux:
      sh:
        command: |
          find ~/ -name "*.doc" -o -name "*.pdf" -o -name "*.xls" 2>/dev/null | xargs grep -l "confidential\|secret\|finance" 2>/dev/null > /tmp/collected.txt
          echo "Found sensitive files:" && cat /tmp/collected.txt
        cleanup: rm -f /tmp/collected.txt

# 3. DATA COMPRESSION BEFORE EXFIL
- id: b2c3d4e5-f6a7-8b9c-0d1e-2f3a4b5c6d7e
  name: Compress Sensitive Data
  description: Archives collected data for exfiltration
  tactic: collection
  technique:
    attack_id: T1560
    name: Archive Collected Data
  platforms:
    windows:
      psh:
        command: |
          powershell "Compress-Archive -Path $env:TEMP\*test*.txt -DestinationPath $env:TEMP\stolen_data.zip"
          echo "Data compressed to ZIP"
        cleanup: del %TEMP%\stolen_data.zip
    linux:
      sh:
        command: |
          zip -r /tmp/stolen_data.zip /tmp/*test*.txt 2>/dev/null
          echo "Data compressed to ZIP"
        cleanup: rm -f /tmp/stolen_data.zip

# 4. USB EXFILTRATION
- id: c3d4e5f6-a7b8-9c0d-1e2f-3a4b5c6d7e8f
  name: Exfiltrate via USB
  description: Copies data to removable USB drive
  tactic: exfiltration
  technique:
    attack_id: T1052.001
    name: Exfiltration over USB
  platforms:
    windows:
      psh:
        command: |
          if exist D:\ (
            copy %TEMP%\stolen_data.zip D:\ 2>nul && echo "Data copied to USB D:"
          ) else (
            echo "No USB drive detected (simulation)"
          )
        cleanup: if exist D:\stolen_data.zip del D:\stolen_data.zip
    linux:
      sh:
        command: |
          if [ -d /media/usb ]; then
            cp /tmp/stolen_data.zip /media/usb/ 2>/dev/null && echo "Data copied to USB"
          else
            echo "No USB drive detected (simulation)"
          fi
        cleanup: rm -f /media/usb/stolen_data.zip 2>/dev/null

# 5. WEB EXFILTRATION
- id: d4e5f6a7-b8c9-0d1e-2f3a-4b5c6d7e8f9a
  name: Exfiltrate via Web
  description: Sends data to external web server
  tactic: exfiltration
  technique:
    attack_id: T1048
    name: Exfiltration Over Alternative Protocol
  platforms:
    windows:
      psh:
        command: |
          $data = "SIMULATED_SENSITIVE_DATA"
          echo "Would exfiltrate: $data to http://exfil-server.com"
        cleanup: ""
    linux:
      sh:
        command: |
          echo "Would exfiltrate data to http://exfil-server.com (simulation)"
        cleanup: ""

# 6. EMAIL EXFILTRATION
- id: e5f6a7b8-c9d0-1e2f-3a4b-5c6d7e8f9a0b
  name: Exfiltrate via Email
  description: Sends sensitive data via email attachment
  tactic: exfiltratie
  technique:
    attack_id: T1048.003
    name: Exfiltration Over Unencrypted/Obfuscated Protocol
  platforms:
    windows:
      psh:
        command: |
          echo "SIMULATION: Email with attachment sent to malicious@domain.com"
        cleanup: ""
    linux:
      sh:
        command: |
          echo "SIMULATION: Email with attachment sent to malicious@domain.com"
        cleanup: ""

# 7. CLOUD STORAGE EXFIL
- id: f6a7b8c9-d0e1-2f3a-4b5c-6d7e8f9a0b1c
  name: Upload to Cloud Storage
  description: Uploads stolen data to cloud services
  tactic: exfiltration
  technique:
    attack_id: T1567.002
    name: Exfiltration to Cloud Storage
  platforms:
    windows:
      psh:
        command: |
          echo "SIMULATION: Data uploaded to cloud storage (Dropbox/Google Drive)"
        cleanup: ""
    linux:
      sh:
        command: |
          echo "SIMULATION: Data uploaded to cloud storage (Dropbox/Google Drive)"
        cleanup: ""

# 8. DLP DETECTION EVASION
- id: a7b8c9d0-e1f2-3a4b-5c6d-7e8f9a0b1c2d
  name: Evade DLP Detection
  description: Attempts to bypass DLP controls
  tactic: defense-evasion
  technique:
    attack_id: T1562.001
    name: Disable or Modify Tools
  platforms:
    windows:
      psh:
        command: |
          echo "Checking for DLP processes..."
          tasklist | findstr /i "mcafee\|symantec\|forcepoint\|dlp"
        cleanup: ""
    linux:
      sh:
        command: |
          echo "Checking for DLP processes..."
          ps aux | grep -i "dlp\|mcafee\|symantec"
        cleanup: ""

# 9. DATA OBFUSCATION
- id: b8c9d0e1-f2a3-4b5c-6d7e-8f9a0b1c2d3e
  name: Obfuscate Sensitive Data
  description: Masks sensitive data before exfiltration
  tactic: defense-evasion
  technique:
    attack_id: T1027
    name: Obfuscated Files or Information
  platforms:
    windows:
      psh:
        command: |
          echo "SIMULATION: Data encoded/obfuscated (Base64/Rot13)"
        cleanup: ""
    linux:
      sh:
        command: |
          echo "SIMULATION: Data encoded/obfuscated (Base64/Rot13)"
        cleanup: ""

# 10. NETWORK SHARE EXFIL
- id: c9d0e1f2-a3b4-5c6d-7e8f-9a0b1c2d3e4f
  name: Exfiltrate via Network Share
  description: Copies data to network share
  tactic: exfiltration
  technique:
    attack_id: T1039
    name: Data from Network Shared Drive
  platforms:
    windows:
      psh:
        command: |
          echo "SIMULATION: Data copied to \\\server\share\"
        cleanup: ""
    linux:
      sh:
        command: |
          echo "SIMULATION: Data copied to smb://server/share/"
        cleanup: ""

# 11. PRINTER EXFILTRATION
- id: d0e1f2a3-b4c5-6d7e-8f9a-0b1c2d3e4f5a
  name: Print Sensitive Documents
  description: Prints sensitive data to physical printer
  tactic: exfiltration
  technique:
    attack_id: T1052
    name: Exfiltration over Physical Medium
  platforms:
    windows:
      psh:
        command: |
          echo "SIMULATION: Document sent to printer"
        cleanup: ""
    linux:
      sh:
        command: |
          echo "SIMULATION: Document sent to printer"
        cleanup: ""

# 12. CLEAR TRACES
- id: e1f2a3b4-c5d6-7e8f-9a0b-1c2d3e4f5a6b
  name: Clear Activity Logs
  description: Cleans traces of malicious activity
  tactic: defense-evasion
  technique:
    attack_id: T1070
    name: Indicator Removal
  platforms:
    windows:
      psh:
        command: |
          echo "SIMULATION: Clearing event logs and temp files"
          del %TEMP%\*.txt /q 2>nul
        cleanup: ""
    linux:
      sh:
        command: |
          echo "SIMULATION: Clearing logs and temp files"
          rm -f /tmp/*test*.txt 2>/dev/null
        cleanup: ""
